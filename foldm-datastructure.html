<p>Folds can be data types:</p>
<pre><code>type Fold a b x = (x → a → x) → x → (x → b) → b

type FoldM (m :: Type → Type) a b x = (x → a → m x) → m x → (x → m b) → m b

Fold ≡ FoldM Identity</code></pre>
<p>Shell from the Haskell <code>turtle</code> library defines a FoldShell as:</p>
<pre><code>data FoldShell a b = ∀x. FoldShell (x → a → IO x) x (x → IO b)</code></pre>
<ul>
<li>The <code>x</code> type refers to the values that are passed between calls of the shell evaluator.</li>
<li><code>a</code> refers to the type of values that are unique to each call to the evaluator.</li>
<li><code>b</code> refers to the type of values that are returned from the shell<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</li>
</ul>
<p>Notice the <code>∀x.</code> on the right hand side of the <code>=</code>. This existential quantification is what allows users of this <code>FoldShell</code> type to specialize the what the intermediate type is for that fold.</p>
<p>A <code>Shell</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> is then defined as:</p>
<pre><code>newtype Shell a = Shell {unShell :: ∀r. FoldShell a r → IO r}</code></pre>
<p>Which is a natural transformation<a href="./natural-transformation.html">(see natural-transformation)</a> from a <code>FoldShell</code> to an <code>IO</code>.</p>
<div id="tag-links" class="tag-links">
<p><a href="./Haskell.html" id="tag-link" class="tag-link" title="Haskell">(see Haskell)</a></p>
<p><a href="./programming.html" id="tag-link" class="tag-link" title="programming">(see programming)</a></p>
<p><a href="./Monads.html" id="tag-link" class="tag-link" title="Monads">(see Monads)</a></p>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Why do we need this? I don’t know. Good question though. My guess is that it allows us to use a different type for the accumulator that’s simplier and then convert that into the “real result” of the fold once we’ve finished. If this is the case then I’d say you could remove it because it forces the author of the fold to think more simply and only write the fold to do just enough for what it needs to do.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>A shell is just the mechanism in which Bash pipes are defined. It’s the datastructure that allows one command to pipe values to another.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
